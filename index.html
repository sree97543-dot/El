<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dr.Tai P.Pandian B.A.,B.L.,PGDFM.,PGDPT., ADVOCATE</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0f1a40 0%, #183d8f 50%, #2a69ac 100%);
      margin: 0;
      min-height: 100vh;
      color: #e0e7ff;
      padding: 20px 30px 60px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #announcement-text {
      font-size: 3.2rem;
      font-weight: 800;
      text-align: center;
      margin: 25px 0;
      font-family: 'Georgia', serif;
    }
    main {
      max-width: 720px;
      width: 100%;
      background: linear-gradient(135deg, #1a2a6c, #27428a);
      border-radius: 26px;
      padding: 48px 42px;
    }
    #searchByContainer {
      display: flex;
      gap: 36px;
      justify-content: center;
      margin-bottom: 38px;
    }
    #searchByContainer input {
      display: none;
    }
    #searchByContainer label {
      background: #fff;
      color: #000;
      padding: 20px 50px;
      border-radius: 36px;
      font-weight: 900;
      cursor: pointer;
    }
    #searchByContainer input:checked + label {
      background: #3b69db;
      color: #fff;
    }
    #searchInput {
      width: 100%;
      padding: 22px 28px;
      border-radius: 18px;
      border: 2px solid #4477dd;
      font-size: 1.5rem;
    }
    button.submit-btn {
      margin-top: 40px;
      width: 100%;
      padding: 22px;
      border-radius: 26px;
      background: #4b77dd;
      color: #fff;
      font-weight: 900;
      border: none;
      cursor: pointer;
    }
    .result {
      margin-top: 40px;
      padding: 32px;
      background: #365796;
      border-radius: 26px;
      display: none;
      white-space: pre-line;
    }
    #suggestions {
      background: #3356a8;
      border-radius: 18px;
      margin-top: 10px;
      display: none;
    }
    #suggestions div {
      padding: 14px 22px;
      cursor: pointer;
    }
    #suggestions div:hover {
      background: #5a7fdb;
    }
  </style>
</head>

<body>

<div id="announcement-text">
  Tamil Nadu & Puducherry Bar Council<br>Election - 2026
</div>

<main>
  <h2 style="text-align:center;">Check Enrollment Details</h2>

  <div id="searchByContainer">
    <input type="radio" id="optionEnrollment" name="searchBy" value="EnrollmentNo" checked>
    <label for="optionEnrollment">Enrollment Number</label>

    <input type="radio" id="optionName" name="searchBy" value="Name">
    <label for="optionName">Name</label>
  </div>

  <input id="searchInput"
         placeholder="Enter Enrollment Number (e.g. 653/1994)"
         oninput="handleInputChange()" />

  <div id="suggestions"></div>

  <button class="submit-btn" onclick="showDetails()">Submit</button>

  <div id="result" class="result"></div>
</main>

<script>
let data = [];

/* ================= LOAD CSV ================= */
async function loadData() {
  try {
    const response = await fetch('data.csv', { cache: 'no-store' });
    if (!response.ok) throw new Error('CSV not found');

    const text = await response.text();
    data = parseCSV(text);
    console.log('✅ CSV loaded:', data.length);
  } catch (err) {
    console.error(err);
    const r = document.getElementById('result');
    r.style.display = 'block';
    r.textContent = '⚠️ Unable to load CSV file.';
  }
}

/* ================= PARSE CSV ================= */
function parseCSV(text) {
  const lines = text.trim().split(/\r?\n/);
  const headers = lines[0].split(',').map(h => h.trim());

  return lines.slice(1).map(line => {
    const values = line.split(',').map(v => v.trim());
    let obj = {};
    headers.forEach((h, i) => obj[h] = values[i] || '');
    return obj;
  });
}

/* ================= INPUT HANDLING ================= */
function handleInputChange() {
  const searchBy = document.querySelector('input[name="searchBy"]:checked').value;
  const query = searchInput.value.toLowerCase().trim();
  if (searchBy !== 'Name' || !query) {
    suggestions.style.display = 'none';
    return;
  }

  const matches = data.filter(d => d.Name.toLowerCase().includes(query)).slice(0, 10);
  if (!matches.length) {
    suggestions.style.display = 'none';
    return;
  }

  suggestions.innerHTML = '';
  matches.forEach(m => {
    const div = document.createElement('div');
    div.textContent = `${m.Name} — ${m.EnrollmentNo}`;
    div.onclick = () => {
      searchInput.value = m.Name;
      suggestions.style.display = 'none';
      showDetails();
    };
    suggestions.appendChild(div);
  });
  suggestions.style.display = 'block';
}

/* ================= SEARCH ================= */
function showDetails() {
  const searchBy = document.querySelector('input[name="searchBy"]:checked').value;
  const val = searchInput.value.trim().toLowerCase();
  const r = document.getElementById('result');

  const record = data.find(d => d[searchBy]?.toLowerCase() === val);

  if (!record) {
    r.style.display = 'block';
    r.textContent = '❌ No matching record found.';
    return;
  }

  r.style.display = 'block';
  r.innerHTML = `
<strong>Enrollment No:</strong> ${record.EnrollmentNo}
<strong>Name:</strong> ${record.Name}
<strong>Gender:</strong> ${record.Gender}
<strong>Father's Name:</strong> ${record.FatherName}
<strong>Bar Association:</strong> ${record.BarAssociation}
<strong>Location:</strong> ${record.Location}
  `;
}

/* ================= INIT ================= */
document.addEventListener('DOMContentLoaded', loadData);
</script>

</body>
</html>
